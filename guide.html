<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æš—è¨˜ã®æ”»ç•¥æœ¬ | æ¥½ã—ã„æš—è¨˜ã‚µã‚¤ãƒˆ</title>
    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Noto+Sans+JP:wght@400;700&family=Outfit:wght@700;900&display=swap"
        rel="stylesheet">
    <!-- Styles -->
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/animations.css">
    <style>
        .guide-header {
            text-align: center;
            padding: 4rem 0 2rem;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 4rem 0 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .skill-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .skill-card {
            background: rgba(20, 20, 31, 0.6);
            border: 1px solid rgba(0, 243, 255, 0.1);
            border-radius: var(--radius-md);
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .skill-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-cyan);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.1);
        }

        .skill-header {
            padding: 1.5rem;
            background: rgba(0, 243, 255, 0.05);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .skill-body {
            padding: 1.5rem;
        }

        .skill-icon {
            font-size: 2rem;
        }

        .skill-tag {
            font-size: 0.8rem;
            padding: 4px 12px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.1);
        }

        .tag-basic {
            color: var(--accent-green);
            border: 1px solid var(--accent-green);
        }

        .tag-advanced {
            color: var(--accent-purple);
            border: 1px solid var(--accent-purple);
        }

        .try-btn {
            display: inline-block;
            margin-top: 1rem;
            padding: 8px 20px;
            background: var(--accent-cyan);
            color: #000;
            font-weight: bold;
            border-radius: 4px;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .try-btn:hover {
            opacity: 1;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 100;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: var(--bg-card);
            border: 1px solid var(--accent-cyan);
            border-radius: var(--radius-lg);
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            position: relative;
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            cursor: pointer;
            font-size: 1.5rem;
        }
    </style>
</head>

<body>
    <div class="container">
        <a href="index.html" class="nav-back" style="position:absolute; top:2rem; left:2rem;">â† Topã«æˆ»ã‚‹</a>

        <header class="guide-header animate-fade-in">
            <span style="color: var(--accent-cyan); font-weight: bold;">AREA 2: STRATEGY GUIDE</span>
            <h1 class="text-gradient">æš—è¨˜ã®æ”»ç•¥æœ¬</h1>
            <p>è¨˜æ†¶ã‚’ãƒãƒƒã‚¯ã™ã‚‹ã€Œæ­¦å™¨ã€ã‚’é¸ã¼ã†ã€‚</p>
        </header>

        <main>
            <!-- ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ -->
            <div style="text-align: center; margin-bottom: 2rem;" class="animate-fade-in delay-100">
                <p style="color: var(--text-muted); font-size: 0.9rem;">è‡ªåˆ†ã«åˆã£ãŸã‚¹ã‚¿ã‚¤ãƒ«ã‚’æ¢ã—ã¦ã¿ã‚ˆã†</p>
            </div>

            <!-- Skill Grid -->
            <div class="skill-grid animate-fade-in delay-200" id="skill-grid">
                <!-- Data will be injected here -->
                <p style="grid-column: 1/-1; text-align: center; color: var(--text-muted);">Loading strategies...</p>
            </div>
        </main>
    </div>

    <!-- Modal Template -->
    <div id="modal" class="modal" onclick="if(event.target === this) closeModal()">
        <div class="modal-content animate-pop-in">
            <span class="close-modal" onclick="closeModal()">Ã—</span>
            <div id="modal-body">
                <!-- Content injected by JS -->
            </div>
        </div>
    </div>

    <script>
        const grid = document.getElementById('skill-grid');
        const modal = document.getElementById('modal');
        let guideData = [];

        // Google Sheet CSV URL (Guide sheet)
        // Using gviz URL for better CSV output
        const SHEET_CSV_URL = 'https://docs.google.com/spreadsheets/d/1IN-PC0r_y6WHSQs1-Xklakj72LYm43q6xUspQ0KueXE/gviz/tq?tqx=out:csv&gid=1225737060';

        // CSV Parser
        function parseCSV(text) {
            const lines = text.split('\n');
            const result = [];

            for (let i = 0; i < lines.length; i++) {
                let line = lines[i].trim();
                if (!line) continue;

                const matches = [];
                let currentMatch = '';
                let inQuote = false;

                for (let j = 0; j < line.length; j++) {
                    const char = line[j];
                    if (char === '"') {
                        inQuote = !inQuote;
                    } else if (char === ',' && !inQuote) {
                        matches.push(currentMatch);
                        currentMatch = '';
                    } else {
                        currentMatch += char;
                    }
                }
                matches.push(currentMatch);

                const row = matches.map(cell => {
                    cell = cell.trim();
                    if (cell.startsWith('"') && cell.endsWith('"')) {
                        cell = cell.slice(1, -1);
                    }
                    return cell.replace(/""/g, '"');
                });

                // Header check: "No","åå‰","åˆ†é¡","å‘ã„ã¦ã„ã‚‹äºº","ä½¿ã„æ–¹","å…·ä½“ä¾‹"
                if (i === 0) continue;
                if (row.length < 6) continue;

                // Simple check if it's a valid data row (e.g. check if ID is a number)
                if (isNaN(parseInt(row[0]))) continue;

                result.push({
                    id: row[0],
                    title: row[1],
                    category: row[2],
                    target: row[3],
                    usage: row[4],
                    example: row[5]
                });
            }
            return result;
        }

        async function loadData() {
            try {
                const response = await fetch(SHEET_CSV_URL);
                if (!response.ok) throw new Error('Network response was not ok');
                const text = await response.text();
                guideData = parseCSV(text);
                render(guideData);
            } catch (error) {
                console.error('Error loading sheet data:', error);
                // Fallback
                try {
                    const response = await fetch('data/guide_methods.json');
                    guideData = await response.json();
                    render(guideData);
                } catch (e) {
                    grid.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: var(--accent-pink);">ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</p>';
                }
            }
        }

        function render(items) {
            grid.innerHTML = '';

            items.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'skill-card animate-fade-in';
                div.style.animationDelay = `${index * 0.05}s`;

                // ã‚¢ã‚¤ã‚³ãƒ³ã®è‡ªå‹•å‰²ã‚Šå½“ã¦ (ç°¡æ˜“çš„)
                let icon = 'ğŸ“';
                if (item.category.includes('ã‚¤ãƒ¡ãƒ¼ã‚¸')) icon = 'ğŸ–¼ï¸';
                else if (item.category.includes('éŸ³å£°') || item.category.includes('éŸ³æ¥½')) icon = 'ğŸµ';
                else if (item.category.includes('æ§‹é€ ') || item.category.includes('æ•´ç†')) icon = 'ğŸ—ï¸';
                else if (item.category.includes('èº«ä½“')) icon = 'ğŸ’ª';
                else if (item.category.includes('åå¾©')) icon = 'ğŸ”';
                else if (item.category.includes('ç‰©èª') || item.category.includes('å‰µä½œ')) icon = 'ğŸ“–';

                // ã‚¿ã‚°ã®è‰²åˆ†ã‘
                let tagClass = 'tag-basic';
                if (item.category.includes('æ§‹é€ ') || item.category.includes('æ•´ç†')) tagClass = 'tag-advanced';

                div.innerHTML = `
                    <div class="skill-header">
                        <span class="skill-icon">${icon}</span>
                        <span class="skill-tag ${tagClass}">${item.category}</span>
                    </div>
                    <div class="skill-body">
                        <h3>${item.title}</h3>
                        <p style="color: var(--text-muted); font-size: 0.9rem; margin: 0.5rem 0; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                            ${item.usage}
                        </p>
                        <span class="try-btn">è©³ç´°ã‚’è¦‹ã‚‹</span>
                    </div>
                `;

                div.addEventListener('click', () => openModal(item));
                grid.appendChild(div);
            });
        }

        function openModal(data) {
            const modalBody = document.getElementById('modal-body');

            modalBody.innerHTML = `
                <div style="margin-bottom: 1.5rem;">
                    <span style="background: rgba(0, 243, 255, 0.1); color: var(--accent-cyan); padding: 4px 12px; border-radius: 20px; font-size: 0.8rem; border: 1px solid rgba(0, 243, 255, 0.3);">
                        ${data.category}
                    </span>
                </div>
                <h2 style="margin-bottom: 1.5rem; color: #fff; font-size: 1.8rem;">${data.title}</h2>
                
                <div style="margin-bottom: 1.5rem;">
                    <h4 style="color: var(--accent-green); margin-bottom: 0.5rem;">ğŸ‘¤ å‘ã„ã¦ã„ã‚‹äºº</h4>
                    <p style="color: var(--text-main); font-size: 0.95rem;">${data.target}</p>
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <h4 style="color: var(--accent-cyan); margin-bottom: 0.5rem;">âš”ï¸ ä½¿ã„æ–¹</h4>
                    <p style="color: var(--text-main); line-height: 1.6;">${data.usage}</p>
                </div>

                <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px; border-left: 3px solid var(--accent-purple);">
                    <h4 style="color: var(--accent-purple); margin-bottom: 0.5rem; font-size: 0.9rem;">ğŸ’¡ å…·ä½“ä¾‹</h4>
                    <p style="color: var(--text-muted); font-size: 0.9rem; line-height: 1.6;">${data.example}</p>
                </div>

                <button onclick="closeModal()" class="btn btn-primary" style="margin-top: 2rem; width: 100%; padding: 12px; background: var(--hover-card); border: 1px solid var(--accent-cyan); color: var(--accent-cyan); font-weight: bold; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                    é–‰ã˜ã‚‹
                </button>
            `;

            // ãƒœã‚¿ãƒ³ã®ãƒ›ãƒãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆï¼ˆã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã§ã‚‚æ›¸ã‘ã‚‹ãŒJSã§åˆ¶å¾¡ã—ã¦ã‚‚ã‚ˆã„ï¼‰
            const btn = modalBody.querySelector('button');
            btn.onmouseover = () => {
                btn.style.background = 'var(--accent-cyan)';
                btn.style.color = '#000';
            };
            btn.onmouseout = () => {
                btn.style.background = 'var(--hover-card)';
                btn.style.color = 'var(--accent-cyan)';
            };

            modal.style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }

        // Init
        loadData();

    </script>
</body>

</html>